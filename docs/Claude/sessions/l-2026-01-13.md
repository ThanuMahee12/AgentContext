# l-2026-01-13

## Project: data-alchemy (bbocax futures mapping)

**Environment:** Linux machine (`l-` prefix)

**Continued from:** l-2026-01-12 (bbocax mapping section)

---

### Summary

Working on `feature/bbocax-futures` branch for `back_office_futures/2.0` mapping.

---

### Key Finding: Correct Mapping Target

**Shovel output only has FuturesBulk files (NOT globalShareFuturesSanctions):**

| File Type | Target Directory | Extensions |
|-----------|------------------|------------|
| `shareFuturesBulk*` | `share_futures/YYYY/YYYYMMDD/` | `.dif`, `.out` |
| `nonShareFuturesBulk*` | `non_share_futures/YYYY/YYYYMMDD/` | `.dif`, `.out` |

**globalShareFuturesSanctions** = NOT in shovel (would be new files, separate MR)

---

### Files Modified

1. **Grabber Map:** `resc/grabber_maps/bloomberg_bbocax_cwiq_pipe_futures_2_0.json`
   - 4 patterns: shareFuturesBulk (with/without date suffix), nonShareFuturesBulk (with/without date suffix)
   - Target: `back_office_futures/2.0/raw/share_futures/` and `non_share_futures/`

2. **Decrypt Inclusion:** `resc/silver_decrypt_inclusions/bloomberg.json`
   - Added: `shareFuturesBulk.*\\.(?:dif|out)\\.gz\\.enc`
   - Added: `nonShareFuturesBulk.*\\.(?:dif|out)\\.gz\\.enc`

---

### Decrypt Inclusion Logic (Clarified)

- `decrypt_filename_patterns` = **whitelist** (files TO decrypt)
- Files IN list → get decrypted
- Files NOT in list → skipped (stay encrypted)
- FuturesBulk files are `.gz.enc` → need explicit inclusion to decrypt

---

### Shovel Output Structure

**`share_futures/YYYY/YYYYMMDD/`** (20 files/date):
- shareFuturesBulkAsia1/2/3.dif/.out
- shareFuturesBulkEuro.dif/.out
- shareFuturesBulkNamr.dif/.out
- shareFuturesBulkOpenAsia1/2/3.dif/.out
- shareFuturesBulkOpenEuro.dif/.out
- shareFuturesBulkOpenNamr.dif/.out

**`non_share_futures/YYYY/YYYYMMDD/`** (18 files/date):
- nonShareFuturesBulkAsia.dif/.out
- nonShareFuturesBulkEuro.dif/.out
- nonShareFuturesBulkLamr.dif/.out
- nonShareFuturesBulkNamr.dif/.out
- nonShareFuturesBulkOpen1Asia.dif/.out
- nonShareFuturesBulkOpenAsia.dif/.out
- nonShareFuturesBulkOpenEuro.dif/.out
- nonShareFuturesBulkOpenLamr.dif/.out
- nonShareFuturesBulkOpenNamr.dif/.out

---

### Next Steps

1. Run pipeline with backfill
2. Verify gold output matches shovel structure
3. Run DQ validation
4. Commit and push changes

---

### Branch Status

| Branch | Target | Status |
|--------|--------|--------|
| `feature/bbocax-futures` | `back_office_futures/2.0` | In progress |
| `feature/bbocax-currency` | `back_office_currency/1.0` | Done |
| `feature/bbocax-equities` | `back_office_equities/1.0` | Done |
| `feature/bbocax-futures-extended` | `back_office_futures_extended/1.0` | TODO |
| `feature/bbocax-preferred-exch` | `back_office_preferred_exch/1.0` | TODO |
| `feature/bbocax-supplemental` | `back_office_supplemental/1.0` | TODO |

---
