# l-2026-01-12

## Project: data-alchemy (bbocax mapping)

**Environment:** Linux machine (`l-` prefix)

**Continued from:** w-2026-01-11 (bbocax mapping section)

**Branch:** `feature/bbocax-new-mapping` → need clean branch `feature/bbocax-grabber-maps`

**Commit:** `2992d9b feat: add 6 bbocax grabber maps for back_office targets`

---

### Summary

Created 6 grabber maps for bbocax_cwiq_pipe → back_office_* targets. Verified target structure from `/sf/proj/data_alchemy/assets/cdp_out/bloomberg/`. Verified no overlap with sf-storage-migration targets.

---

### Coverage Verification (Final)

| Target | data-alchemy | sf-migration | Status |
|--------|--------------|--------------|--------|
| back_office_commodity | ❌ | ❌ | No source in cwiq-pipe |
| back_office_convert_bonds | ❌ | ✅ | sf-migration handles |
| back_office_currency | ✅ | ❌ | **Our map** |
| back_office_equities | ✅ | ❌ | **Our map** |
| back_office_futures | ✅ | ❌ | **Our map** |
| back_office_futures_extended | ✅ | ❌ | **Our map** |
| back_office_gov_bonds | ❌ | ✅ | sf-migration handles |
| back_office_preferred_bonds | ❌ | ✅ | sf-migration handles |
| back_office_preferred_exch | ✅ | ❌ | **Our map** |
| back_office_supplemental | ✅ | ❌ | **Our map** |
| global_economic_indicators | ❌ | ✅ | sf-migration handles |
| market_calendar | ❌ | ✅ | sf-migration handles |

---

### New Grabber Maps Target Paths

```
/sf/data/bloomberg/back_office_currency/1.0/raw/
/sf/data/bloomberg/back_office_equities/1.0/raw/
/sf/data/bloomberg/back_office_futures/1.0/raw/
/sf/data/bloomberg/back_office_futures_extended/1.0/raw/share_futures_extended/
/sf/data/bloomberg/back_office_futures_extended/1.0/raw/non_share_futures_extended/
/sf/data/bloomberg/back_office_preferred_exch/1.0/raw/
/sf/data/bloomberg/back_office_supplemental/1.0/raw/
```

---

### sf-migration Target Paths (NOT our scope)

```
/sf/data/bloomberg/back_office_convert_bonds/1.0/raw/
/sf/data/bloomberg/back_office_gov_bonds/1.0/raw/
/sf/data/bloomberg/back_office_preferred_bonds/1.0/raw/
/sf/data/bloomberg/corporate_events_calendar/1.0/raw/
/sf/data/bloomberg/global_economic_indicators/1.0/raw/
/sf/data/bloomberg/market_calendar/1.0/raw/
/sf/data/bloomberg/quantbeam/1.0/raw/
```

---

### Grabber Maps Created (6 mappings) ✅

| # | Grabber Map | Target | Subdirectory |
|---|-------------|--------|--------------|
| 1 | `bloomberg_bbocax_cwiq_pipe_currency_1_0.json` | back_office_currency/1.0/raw/ | No |
| 2 | `bloomberg_bbocax_cwiq_pipe_equities_1_0.json` | back_office_equities/1.0/raw/ | No |
| 3 | `bloomberg_bbocax_cwiq_pipe_futures_1_0.json` | back_office_futures/1.0/raw/ | No |
| 4 | `bloomberg_bbocax_cwiq_pipe_futures_extended_1_0.json` | back_office_futures_extended/1.0/raw/ | Yes: share_/non_share_ |
| 5 | `bloomberg_bbocax_cwiq_pipe_preferred_exch_1_0.json` | back_office_preferred_exch/1.0/raw/ | No |
| 6 | `bloomberg_bbocax_cwiq_pipe_supplemental_1_0.json` | back_office_supplemental/1.0/raw/ | No |

**Pattern features:**
- All patterns handle optional `.gz` suffix: `(?:\.gz)?`
- Files with date suffix (`.csv.20251213`) → extract date from suffix
- Files without date suffix → use silver directory date
- `futures_extended` routes to subdirectories

---

### File Pattern Details

| Grabber Map | Source Patterns | Extensions |
|-------------|-----------------|------------|
| currency | `curncy*` | .csv, .parquet |
| equities | `equity(?!Options|Index)*`, `equityWarrant*`, `equitySec13f2*` | .csv, .parquet |
| futures | `globalShareFuturesSanctions*` | .csv, .parquet |
| futures_extended | `shareFuturesExtended*`, `nonShareFuturesExtended*` | .csv, .parquet |
| preferred_exch | `pfdExch*Pricing*`, `pfdExch*HistoricalPricing*` | .csv, .parquet |
| supplemental | `condition_code.out`, `fields.csv`, `fields.dif` | .out, .csv, .dif |

---

### Not Mapped (by design)

- **back_office_commodity** - no source files in cwiq-pipe
- **equityOptions, equityIndexOptions** - no target directory exists
- **bonds, calendar, indicators** - sf-migration handles from /mktdata/BLOOMBERG/

---

### Next Steps

1. Create clean branch `feature/bbocax-grabber-maps` from dev with only grabber map commit
2. Test pipeline with new grabber maps
3. Run with `--default-mapping` to find uncategorized files
4. Verify gold output paths match `/sf/proj` structure

---
